## test-webapp-hpa

### Задача:

Опишите deployment для веб-приложения в kubernetes в виде yaml-манифеста. Оставляйте в коде комментарии по принятым решениям. Есть следующие вводные:

- у нас мультизональный кластер (три зоны), в котором пять нод
- приложение требует около 5-10 секунд для инициализации
  - Redines/Livenes Probes 10 s
  
- по результатам нагрузочного теста известно, что 4 пода справляются с пиковой нагрузкой
  - используем HPA Max resource 4 pods min - 2 pods
  
- на первые запросы приложению требуется значительно больше ресурсов CPU, в дальнейшем потребление ровное в районе 0.1 CPU. По памяти всегда “ровно” в районе 128M memory
  - Делаем Guaranteed QoS class CPU - 100m RAM - 128m - ну 130 плюс/минус 
  Скачки по CPU отработает HPA, даже если нет - CPU эластичный ресурс будет тупить, но отработает (мы же хотим сэкономить бабло на ресурсах)
  
- приложение имеет дневной цикл по нагрузке – ночью запросов на порядки меньше, пик – днём 
  - Horizontal Pod Autoscaler

- хотим максимально отказоустойчивый deployment 
  - Это min 2 pods in different zones - Делаем Affinity

- хотим минимального потребления ресурсов от этого deployment’а 
  - Ресурсы Pod'a ограничили, ограничим maxReplicas: 4 (HPA)
